---

- name: Test simple action
  ignore_errors: true
  ignore_unreachable: true
  simple_action:
  register: test_simple_action_res

- name: Check simple action result
  assert:
    that:
      - test_simple_action_res | type_debug == 'dict'
      - test_simple_action_res['changed'] == false
      - test_simple_action_res['skipped'] == false
      - test_simple_action_res['failed'] == false
      - test_simple_action_res['simple_res'] == 'for a simple action'

- name: Test simple action with param, without providing required param
  ignore_errors: true
  ignore_unreachable: true
  simple_action_with_param:
  register: test_simple_action_with_param_with_missing_param_res

- name: Check simple action with param result
  assert:
    that:
      - "test_simple_action_with_param_with_missing_param_res | type_debug == 'dict'"
      - "test_simple_action_with_param_with_missing_param_res['changed'] == false"
      - "test_simple_action_with_param_with_missing_param_res['skipped'] == false"
      - "test_simple_action_with_param_with_missing_param_res['failed'] == true"
      - "'Errors during argspec validation for simple_action_with_param plugin' == test_simple_action_with_param_with_missing_param_res['msg']"
      - "['missing required arguments: name'] == test_simple_action_with_param_with_missing_param_res['errors']"

- name: Test simple action with param, providing extra param
  ignore_errors: true
  ignore_unreachable: true
  simple_action_with_param:
    name: 'my_name'
    unexpected_param: 'my_unexpected_param'
  register: test_simple_action_with_param_with_unexpected_param

- name: Check simple action with param result
  assert:
    that:
      - "test_simple_action_with_param_with_unexpected_param | type_debug == 'dict'"
      - "test_simple_action_with_param_with_unexpected_param['changed'] == false"
      - "test_simple_action_with_param_with_unexpected_param['skipped'] == false"
      - "test_simple_action_with_param_with_unexpected_param['failed'] == true"
      - "'Errors during argspec validation for simple_action_with_param plugin' == test_simple_action_with_param_with_unexpected_param['msg']"
      - "['Unsupported parameters for \\'simple_action_with_param\\' module: unexpected_param Supported parameters include: name'] == test_simple_action_with_param_with_unexpected_param['errors']"
